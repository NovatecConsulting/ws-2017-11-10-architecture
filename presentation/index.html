<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">


		<title>Verteilte Konfiguration und Verwaltung sensibler Daten mit Spring Cloud Config und Vault</title>
        <meta name="description" content="Verteilte Konfiguration und Verwaltung sensibler Daten mit Spring Cloud Config und Vault">
        <meta name="author" content="Andreas Falk">

        <link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/white.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

        <link rel="stylesheet" href = "http://slidifylibraries2.googlecode.com/git/inst/libraries/widgets/bootstrap/css/bootstrap.css">


        <!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">

                <!-- Introduction -->
                <section>
                    <div>
                        <h3>Software Architecture</h3>
                        <p>Andreas Falk</p>
                        <p>10.11.2017</p>
                        <p><a href="https://github.com/nt-ca-aqe/ws-2017-11-10-architecture">Presentation and Workshop:<br> https://github.com/nt-ca-aqe/ws-2017-11-10-architecture</a></p>
                        <img src="images/ipoint.png" class="plain">
                    </div>
                </section>
                <section data-background="images/" data-background-size="75%">
                    <h3>Andreas Falk</h3>
                    andreas.falk@novatec-gmbh.de<br>
                    <img class="plain" src="images/profile.png" width="70%">
                </section>
                <section>
                    <h1>Agenda</h1>
                    <p class="fragment">What is Software Architecture</p>
                    <p class="fragment">Software Craftsmanship</p>
                    <p class="fragment">Testautomation</p>
                    <p style="color: blue" class="fragment">Lunch Break</p>
                    <p class="fragment">Test-Driven Development (TDD)</p>
                    <p class="fragment">Spring Testing (Optional)</p>
                    <p class="fragment">Security Testing (Optional)</p>
                    <p class="fragment">Q&A</p>
                </section>
                <section>
                    <h2>Requirements for Workshop</h2>
                    <ul>
                        <li>Java 8</li>
                        <li>Maven</li>
                        <li>IntelliJ or Eclipse IDE (STS)</li>
                    </ul>
                </section>
                <section>
                    <h2>Vorstellungsrunde</h2>
                    <ul>
                        <li>Was ist für Sie <q>Software Testing</q>?</li>
                        <li>Warum sind Sie heute hier?</li>
                        <li>Haben Sie (projekt-)spezifische Problemstellungen</li>
                        <li>Was möchten Sie durch den Workshop erreichen?</li>
                    </ul>
                </section>
                <section>
                    <h1>Architecture?</h1>
                    <img src="images/architecture-1207184.jpg" class="plain" width="40%">
                </section>
                <section>
                    <h1>What is Software Architecture?</h1>
                    <img src="images/5mins.png" class="plain" width="150px">
                </section>
                <section tagcloud>
                    Clean Code
                    Architectural Patterns
                    S.O.L.I.D.
                    Design Patterns
                    Domain Driven Design
                    Decisions
                    Design Thinking
                    Consultancy
                    Software
                    Communication
                    Riskmanagement
                    K.I.S.S.
                    Separation Of Concerns
                    Conway's Law
                    Technical Debts
                    Quality
                    Documentation
                    Review
                </section>
                <section>
                    <h3>EU General Data Protection Regulation (GDPR)</h3>
                    &ldquo;...should adopt internal policies and implement measures which meet in particular the principles of <u>data protection by
                    design</u> and <u>data protection by default</u>&rdquo;
                    <p><small><a href="http://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=CELEX:32016R0679">http://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=CELEX:32016R0679 (78)</a></small></p>
                </section>
                <section>
                    <h3>Architecture Layers</h3>
                    <img src="images/architecture_layers.png" class="plain" width="100%">
                </section>

                <!-- Software Craftsmenship -->

                <section>
                    <section>
                        <h1>Software Craftsmenship</h1>
                    </section>
                    <section>
                        <img src="images/clean_code.jpg" class="plain">
                    </section>
                    <section>
                        <img src="images/craftmenship_books.png" class="plain" >
                    </section>
                    <section>
                        <h2>"We need to be professionals"</h2>
                        <h2>"We will not ship shit"</h2>
                        <h4>Bob Martin</h4>
                        <small>
                            <a href="http://gmusicant.com/robert-c-martin-demanding-professionalism-in-software-development">Demanding Professionalism in Software Development</a>
                        </small>
                    </section>
                    <section>
                        <h2>"Not Just Code Monkeys"</h2>
                        <h4>Martin Fowler</h4>
                        <small>
                            <a href="https://www.youtube.com/watch?v=Z8aECe4lp44">OOP 2014 Keynote</a>
                        </small>
                    </section>
                    <section>
                        <h2>Agile Manifesto</h2>
                        <p><strong>Individuals and interactions</strong> over processes and tools</p>
                        <p><strong>Working software</strong> over comprehensive documentation</p>
                        <p><strong>Customer collaboration</strong> over contract negotiation</p>
                        <p><strong>Responding to change</strong> over following a plan</p>
                        <p class="fragment"><strong>Craftsmanship</strong> over Execution <sup>*)</sup></p>
                        <small>
                            <p><a href="http://agilemanifesto.org">http://agilemanifesto.org</a></p>
                            <p class="fragment"><a href="https://www.infoq.com/news/2008/08/manifesto-fifth-craftsmanship">*) https://www.infoq.com/news/2008/08/manifesto-fifth-craftsmanship</a></p>
                        </small>
                    </section>
                    <section tagcloud>
                        Clean Code
                        Clean Architecture
                        Object Oriented Design Patterns
                        Object Oriented Design Principles
                        Software Architecture
                        Domain Driven design
                        Refactoring
                        Pair Programming
                        Code Review
                        Coding Dojos
                        Test Driven Design (TDD)
                    </section>
                    <section>
                        <h2>SOLID</h2>
                        <ul>
                            <li class="fragment"><strong>S</strong>ingle Responsibility Principle</li>
                            <li class="fragment"><strong>O</strong>pen/Closed Principle</li>
                            <li class="fragment"><strong>L</strong>iskov's Substitution Principle</li>
                            <li class="fragment"><strong>I</strong>nterface Segregation Principle</li>
                            <li class="fragment"><strong>D</strong>ependency Inversion Principle</li>
                        </ul>
                        <aside class="notes">
                            Klassen sollten einen einzelnen Zweck erfüllen, und daher nur einen Grund zur Änderung haben
                            Die Funktionalität einer Klasse sollte erweiterbar sein, ohne sie zu verändern. (Open for extension, closed for modification)
                            Subklassen sollten die Semantik ihrer Überklassen nicht verändern. Dadurch sollten Objekte durch Instanzen ihrer Subklassen ersetzbar sein, ohne Fehler zu verursachen.
                            Interfaces sollen so wenige Methoden definieren, dass implementierende Klassen keine Methoden implementieren müssen, die nicht benutzt werden.
                        </aside>
                    </section>
                    <section>
                        <h2>Single Responsibility Principle</h2>
                        <p><em>A class should have only one reason to change</em></p>
                    </section>
                    <section>
                        <h2>Open-Closed Principle</h2>
                        <p><em>You should be able to extend a classes behavior, without modifying it</em></p>
                    </section>
                    <section>
                        <h2>Liskov Substitution Principle</h2>
                        <p><em>Derived classes must be substitutable for their base classes</em></p>
                    </section>
                    <section>
                        <h2>Interface Segregation Principle</h2>
                        <p><em>Make fine grained interfaces that are client specific</em></p>
                    </section>
                    <section>
                        <h2>Dependency Inversion Principle</h2>
                        <p><em>Depend on abstractions, not on concretions</em></p>
                    </section>
                    <section>
                        <h2>Enforcing Clean Code</h2>
                        <ul>
                            <li>Pair Programming</li>
                            <li>Code Review</li>
                            <li>Static Code Analysis (e.g. PMD, FindBugs)</li>
                            <li>Coding Dojos</li>
                        </ul>
                    </section>
                </section>

                <section data-background="images/background_normal.png" data-background-size="75%">
                    <h2>Typical Sensitive Data</h2>
                    <h4 class="fragment fade-up">Passwords</h4>
                    <h4 class="fragment fade-up">Service credentials (DB, Messaging, ...)</h4>
                    <h4 class="fragment fade-up">OAuth2 client secrets</h4>
                    <h4 class="fragment fade-up">Encryption keys</h4>
                    <h4 class="fragment fade-up">Credit card numbers</h4>
                    <h4 class="fragment fade-up">Personal data</h4>
                </section>
                <section data-background="images/background_normal.png" data-background-size="75%">
                    <img src="images/spring_properties.png" class="plain" width="75%">
                </section>
                <section data-background="images/background_normal.png" data-background-size="75%">
                    <h2>Application-xxx.Yaml</h2>
                    <h4>Database access credentials</h4>
                    <pre><code class="properties" data-trim>
                        spring:
                            datasource:
                                url: jdbc:postgresql://localhost/test
                                username: root
                                password: mysupersecretpassword
                    </code></pre>
                </section>
                <section data-background="images/background_normal.png" data-background-size="75%">
                    <h1>Key Management</h1>
                    <img src="images/babuschka.jpg" class="plain" width="60%">
                </section>
                <section data-background="images/background_normal.png" data-background-size="75%">
                    <h2>Security Evolution</h2>
                    <img src="images/security_evolution.png" class="plain" width="70%">
                </section>

                <!-- Vault -->

                <section>
                    <section data-background="images/background_normal.png" data-background-size="75%">
                        <h2>Introduction</h2>
                        <img src="images/vault-black.png" class="plain" width="70%">
                        <a href="https://www.vaultproject.io/">https://www.vaultproject.io</a>
                    </section>
                    <section data-background="images/background_normal.png" data-background-size="75%">
                        <img src="images/army.jpg" class="plain" width="40%">
                        <p>
                            &ldquo;A Security Swiss Army Knife&rdquo;
                        </p>
                        <p>Jeff Mitchell, Vault Lead, HashiCorp</p>
                    </section>
                    <section data-background="images/background_normal.png" data-background-size="75%">
                        <h3>A Tool for Managing Secrets like...</h3>
                        <ul>
                            <li>Tokens</li>
                            <li>Passwords</li>
                            <li>MFA</li>
                            <li>X.509 Certificates</li>
                            <li>API keys</li>
                            <li>DB credentials</li>
                        </ul>
                    </section>
                    <section data-background="images/background_normal.png" data-background-size="75%">
                        <h2>Key Features</h2>
                        <h4>Secure Secret Storage</h4>
                        <h4>Dynamic Secrets</h4>
                        <h4>Data Encryption (AES cypher)</h4>
                        <h4>Leasing, Renewal & Revocation</h4>
                    </section>
                    <section data-background="images/background_normal.png" data-background-size="75%">
                        <h2>Operational Features</h2>
                        <h4>Authentication</h4>
                        <h4>Authorization (ACL)</h4>
                        <h4>Audit Logs</h4>
                        <h4>High Availability Mode (HA)</h4>
                    </section>
                    <section data-background="images/background_normal.png" data-background-size="75%">
                        <h2>Architecture</h2>
                        <img src="images/vault_architecture.png" class="plain" width="1500px">
                    </section>
                    <section data-background="images/background_normal.png" data-background-size="75%">
                        <h2>Storage</h2>
                        <img src="images/vault_storage.png" class="plain">
                    </section>
                    <section data-background="images/background_normal.png" data-background-size="75%">
                        <h2>Secrets</h2>
                        <img src="images/vault_secrets.png" class="plain">
                    </section>
                    <section data-background="images/background_normal.png" data-background-size="75%">
                        <h2>Authentication</h2>
                        <img src="images/vault_authentication.png" class="plain" width="75%">
                    </section>
                    <section data-background="images/background_normal.png" data-background-size="75%">
                        <h2>Key Shares</h2>
                        <img src="images/key_shares.png" class="plain">
                        <aside class="notes">
                            Vault uses a technique known as Shamir's secret sharing algorithm to split
                            the master key into 5 shares, any 3 of which are required to reconstruct the master key.
                        </aside>
                    </section>
                </section>

                <!-- Spring Vault -->
                <section>
                    <section data-background="images/background_normal.png" data-background-size="75%">
                        <h2>Spring Vault</h2>
                        <img src="images/spring_vault.png" class="plain">
                        <p>
                            <small><a href="https://projects.spring.io/spring-vault">
                                https://projects.spring.io/spring-vault</a></small>
                        </p>
                    </section>
                    <section data-background="images/background_normal.png" data-background-size="75%">
                        <img src="images/spring_vault_overview.png" class="plain">
                    </section>

                    <section data-background="images/background_normal.png" data-background-size="75%">
                        <h2>Encryption as a service</h2>
                        <img src="images/spring_vault_transit.png" class="plain">
                    </section>
                </section>

                <!-- Spring Cloud Vault -->
                <section>
                    <section data-background="images/background_normal.png" data-background-size="75%">
                        <h2>Spring Cloud Vault</h2>
                        <img src="images/spring_cloud_vault.png" class="plain">
                        <p>
                            <small><a href="https://cloud.spring.io/spring-cloud-vault">
                                https://cloud.spring.io/spring-cloud-vault</a></small>
                        </p>
                    </section>
                    <section data-background="images/background_normal.png" data-background-size="75%">
                        <img src="images/springcloud_vault.png" class="plain">
                    </section>

                    <section data-background="images/background_normal.png" data-background-size="75%">
                        <h2>Secret vault mapping</h2>
                        <h4>bootstrap.properties</h4>
                        <pre><code class="properties" data-trim>
                            spring.cloud.vault.generic.application-name =
                                    application1,additional/keys
                            #spring.cloud.vault.application-name = ...
                            #spring.application.name = ...
                        </code></pre>
                        <h4>Mapped secret paths in vault</h4>
                        <pre><code class="uri" data-trim>
                            /secret/application1
                            /secret/application1/myprofile
                            /secret/additional/keys
                            /secret/application
                            /secret/application/myprofile
                        </code></pre>
                    </section>
                    <section data-background="images/background_normal.png" data-background-size="75%">
                        <h2>Rotate Database Credentials</h2>
                        <h4>bootstrap.yml</h4>
                        <pre><code class="yaml" data-trim>
                            spring.cloud.vault:
                                postgresql:
                                    enabled: true
                                    role: readonly
                                    backend: postgresql
                                    username-property: spring.datasource.username
                                    password-property: spring.datasource.username
                        </code></pre>
                    </section>
                    <section data-background="images/background_normal.png" data-background-size="75%">
                        <img src="images/springcloudconfig_vault.png" class="plain">
                    </section>
                    <section data-background="images/background_normal.png" data-background-size="75%">
                        <h2>Spring Cloud Config Vault Environment Repository</h2>
                        <h4>application.properties (Config Server)</h4>
                        <pre><code class="properties" data-trim>
                            spring.profiles.active=git,vault
                            spring.cloud.config.server.vault.host=127.0.0.1
                            spring.cloud.config.server.vault.port=8200
                            spring.cloud.config.server.vault.scheme=https
                        </code></pre>
                        <h4>bootstrap.properties (Client)</h4>
                        <pre><code class="properties" data-trim>
                            spring.cloud.config.token = YourVaultToken
                        </code></pre>
                    </section>
                </section>

                <!-- Cloud Foundry Vault Service Broker -->

                <section>
                    <section data-background="images/background_normal.png" data-background-size="75%">
                        <img src="images/cloudfoundry_vault.png" class="plain" width="70%">
                        <a href="https://github.com/hashicorp/vault-service-broker">https://github.com/hashicorp/vault-service-broker</a>
                        <a href="https://github.com/pivotal-cf/spring-cloud-vault-connector">https://github.com/pivotal-cf/spring-cloud-vault-connector</a>
                    </section>
                </section>

                <!-- The end -->

                <section data-background="images/background_normal.png" data-background-size="75%">
                    <h1>Q&A</h1>
                    <p>http://www.novatec-gmbh.de</br>
                    http://blog.novatec-gmbh.de</p>
                    <p>andreas.falk@novatec-gmbh.de</p>
                    <p>@NT_AQE, @andifalk</p>
                </section>
                <section data-background="images/background_normal.png" data-background-size="75%">
                    <h2>References</h2>
                    <small>
                        <ul>
                            <li><a href="https://cloud.spring.io/spring-cloud-config/">Spring Cloud Config (https://cloud.spring.io/spring-cloud-config/)</a></li>
                            <li><a href="https://en.wikipedia.org/wiki/Shamir's_Secret_Sharing">Shamir's secret sharing (https://en.wikipedia.org/wiki/Shamir's_Secret_Sharing)</a></li>
                            <li><a href="https://cloud.spring.io/spring-cloud-vault">Spring Cloud Vault (https://cloud.spring.io/spring-cloud-vault)</a></li>
                            <li><a href="https://www.vaultproject.io">Vault (https://www.vaultproject.io)</a></li>
                            <li><a href="https://github.com/hashicorp/vault-service-broker">Cloud Foundry Vault Service Broker (https://github.com/hashicorp/vault-service-broker)</a></li>
                            <li><a href="https://github.com/andifalk/cf-summit-2017">Sources and Presentation (https://github.com/andifalk/cfsummit2017)</a></li>
                        </ul>
                        <p>All images used are from <a href="https://pixabay.com/">Pixabay</a> and are published under <a href="http://creativecommons.org/publicdomain/zero/1.0/deed.en">Creative Commons CC0 license.</a></p>
                        All used logos are trademarks of corresponding companies
                    </small>
                </section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>


		<script>
			Reveal.initialize({
                controls: true,
                progress: true,
                history: true,
                center: true,
                pdfMaxPagesPerSlide: 1,
                allottedTime: 45 * 60 * 1000, // 45 minutes

                transition: 'slide', // none/fade/slide/convex/concave/zoom
				dependencies: [
                    { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
                    { src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
                    { src: 'plugin/print-pdf/print-pdf.js' },
                    { src: 'plugin/zoom-js/zoom.js', async: true },
                    { src: 'plugin/notes/notes.js', async: true },
                    { src: 'plugin/tagcloud/tagcloud.js', async: true },
                    { src: 'plugin/elapsed-time-bar/elapsed-time-bar.js'},
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() {
					    hljs.initHighlightingOnLoad(); }
					}
				]
			});
            Reveal.configure({ slideNumber: 'c/t' });
		</script>
	</body>
</html>
